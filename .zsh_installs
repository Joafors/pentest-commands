#!/bin/zsh

CURR_SHELL="zsh"
RC_FILE=".$CURR_SHELL"rc
WHO_AM_I=$(whoami)
RC_FILE_LOCATION="/home/$WHO_AM_I"

echo -e "\033[1;32m[+]\033[0m The current shell is $CURR_SHELL"

alias_array=(
"alias common=\"/usr/bin/cat ~/pentest-commands/commands/common\""
"alias revshells=\"/usr/bin/cat ~/pentest-commands/commands/revshells\""
"alias linhold=\"/usr/bin/cat ~/pentest-commands/commands/linux/linhold\""
"alias ttys=\"/usr/bin/cat ~/pentest-commands/commands/linux/ttys\""
"alias linesc=\"/usr/bin/cat ~/pentest-commands/commands/linux/linesc\""
"alias kernsploit=\"/usr/bin/cat ~/pentest-commands/commands/linux/kernsploit\""
"alias lintran=\"/usr/bin/cat ~/pentest-commands/commands/linux/lintran\""
"alias wintran=\"/usr/bin/cat ~/pentest-commands/commands/windows/wintran\""
"alias winhold=\"/usr/bin/cat ~/pentest-commands/commands/windows/winhold\""
"alias powercom=\"/usr/bin/cat ~/pentest-commands/commands/windows/powercom\""
"alias brutecom=\"/usr/bin/cat ~/pentest-commands/commands/tools/brutecom\""
"alias mailcom=\"/usr/bin/cat ~/pentest-commands/commands/services/mailcom\""
"alias commands=\"/usr/bin/python3 ~/pentest-commands/helper/guide.py\""
)

file_path="$RC_FILE_LOCATION/$RC_FILE"

echo -e "\033[1;33m[!]\033[0m Creating a backup of existing $RC_FILE"
cp "$file_path" "$file_path.bak"

if [ -e "$file_path" ]; then

    echo $file_path
    tmp_file="tmpfile"

    for element in "${alias_array[@]}"; do
        if ! grep -qF "$element" "$file_path"; then
            echo -e "\033[1;32m[+]\033[0m Prepending $element to $file_path"
            echo "$element" | cat - "$file_path" > "$tmp_file"
            chown $USER:$USER $tmp_file
            mv "$tmp_file" "$file_path"
        else
            echo -e "\033[1;33m[!]\033[0m A line already exists in $file_path, skipping."
        fi
    done

    echo -e "\033[1;32m[+]\033[0m Sourcing the updated file $file_path"
    source "$file_path"

    echo -e "\033[1;33m[!]\033[0m If you still can't use the aliases, you might need to open a new terminal."
else
    echo -e "\033[1;35m[!]\033[0m The file you're trying to append to does not exist!"
    exit
fi
