\033[0;34m##################################################################################
\033[1;35m=== NOPASSWD ===\033[0m
sudo -l

\033[0;31mexample:\033[0m
User demo may run the following commands on crashlab:
    (root) NOPASSWD: /usr/bin/vim

find / -perm -4000 -type f -exec ls -la {} 2>/dev/null \;

\033[0;34m##################################################################################
\033[1;35m=== Find SUID Binaries ===\033[0m
find / -perm -u=s -type f -exec ls -la {} 2>/dev/null \;

\033[0;34m##################################################################################
\033[1;35m=== Find GUID Binaries ===\033[0m
find / -perm -g=s -type f -exec ls -la {} 2>/dev/null \;

\033[0;34m##################################################################################
\033[1;35m=== Cronjobs ===\033[0m
cat /etc/crontab

crontab -l

systemctl list-timers --all

\033[0;34m##################################################################################
\033[1;35m=== Stored Passwords ===\033[0m
history
cat ~/.bash_history
cat ~/.zsh_history

\033[0;31m- Files containing passwords -\033[0m
grep --color=auto -rnw '/' -ie "PASSWORD" --color=always 2>/dev/null

find . -type f -exec grep -i -I "PASSWORD" {} 2>/dev/null \; 

\033[0;31m- Old passwords -\033[0m
cat /etc/security/opasswd 

\033[0;31m- Last edited files -\033[0m
find / -mmin -10 2> /dev/null | grep -Ev "^/proc"

\033[0;31m- In memory passwords -\033[0m
strings /dev/mem -n10 | grep -i "PASS"

\033[0;34m##################################################################################
\033[1;35m=== Weak file permission ===\033[0m
ls -la /etc/passwd
ls -la /etc/shadow

ls -la /<path_to_file>

\033[0;34m##################################################################################
\033[1;35m=== Writable files/dirs ===\033[0m
find / -writable ! -user `whoami` -type f ! -path "/proc/*" ! -path "/sys/*" -exec ls -al {} \; 2>/dev/null

find / -perm -2 -type f 2>/dev/null

find / ! -path "*/proc/*" -perm -2 -type f -print 2>/dev/null

\033[0;34m##################################################################################
\033[1;35m=== Find SSH Keys ===\033[0m
find / -name authorized_keys 2> /dev/null

find / -name id_rsa 2> /dev/null

\033[0;34m##################################################################################
\033[1;35m=== System enumeration ===\033[0m
\033[0;31m- System information -\033[0m
hostname
uname -a 
cat /etc/*-release
cat /proc/version
lscpu

\033[0;31m- Processes -\033[0m
ps -auxf
ps -aux
ps -aux | grep -i "root" --color=auto
ps -aux | grep -i "cron" --color=auto

\033[0;31m- processes being ran by root (REALTIME) -\033[0m
top -u root -c

\033[1;31mIn "top" press "o" and enter COMMAND=</bin/sh> to filter for specific scripts etc.\033[0m

\033[0;31m- List binaries within /usr -\033[0m
ls -lh /usr/bin

\033[0;31m- List binaries within /sbin -\033[0m
ls -la /usr/sbin

\033[0;31m- List RPM-based packages -\033[0m
rpm -qa

\033[0;31m- List Debian-based packages -\033[0m
dpkg -l

\033[0;34m##################################################################################
\033[1;35m=== User information ===\033[0m
cat /etc/passwd | grep sh$

id
whoami
groups

cat /etc/groups

\033[0;31m- Interesting files -\033[0m
find / -type f -name <user> 2>/dev/null | grep -Ev "^/proc"
find / -mmin -10 2>/dev/null | grep -Ev "^/proc"

\033[0;31m- Logged in information -\033[0m
w
who
last

\033[0;31m- Sudo permissions -\033[0m
sudo -l

\033[0;31m- Switch User -\033[0m
su <user>
sudo su -

\033[0;31m- Sudo version -\033[0m
sudo --version

\033[0;34m##################################################################################
\033[1;35m=== Network Enumeration ===\033[0m
ifconfig
ip a

ss -tuln
ss -lvntp

ip route
ip neigh

netstat -anl

cat /etc/resolv.conf
cat /etc/hosts
\033[0;34m##################################################################################\033[0m
\n
