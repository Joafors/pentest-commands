##################################################################################
=== NOPASSWD ===
sudo -l

example:
User demo may run the following commands on crashlab:
    (root) NOPASSWD: /usr/bin/vim

find / -perm -4000 -type f -exec ls -la {} 2>/dev/null \;
##################################################################################
=== Find SUID Binaries ===
find / -perm -u=s -type f -exec ls -la {} 2>/dev/null \;
##################################################################################
=== Find GUID Binaries ===
find / -perm -g=s -type f -exec ls -la {} 2>/dev/null \;
##################################################################################
=== Cronjobs ===
cat /etc/crontab

crontab -l

systemctl list-timers --all
##################################################################################
=== Stored Passwords ===
history
cat ~/.bash_history
cat ~/.zsh_history

- Files containing passwords -
grep --color=auto -rnw '/' -ie "PASSWORD" --color=always 2>/dev/null

find . -type f -exec grep -i -I "PASSWORD" {} 2>/dev/null \; 

- Old passwords -
cat /etc/security/opasswd 

- Last edited files -
find / -mmin -10 2> /dev/null | grep -Ev "^/proc"

- In memory passwords -
strings /dev/mem -n10 | grep -i "PASS"
##################################################################################
=== Weak file permission ===
ls -la /etc/passwd
ls -la /etc/shadow

ls -la /<path_to_file>
##################################################################################
=== Writable files ===
find / -writable ! -user `whoami` -type f ! -path "/proc/*" ! -path "/sys/*" -exec ls -al {} \; 2>/dev/null

find / -perm -2 -type f 2>/dev/null

find / ! -path "*/proc/*" -perm -2 -type f -print 2>/dev/null
##################################################################################
=== Find SSH Keys ===
find / -name authorized_keys 2> /dev/null

find / -name id_rsa 2> /dev/null
##################################################################################
=== System information ===
- System information -
hostname
uname -a 
cat /etc/*-release
cat /proc/version
lscpu

- Processes -
ps -auxf
ps -aux
ps -aux | grep -i "root" --color=auto
ps -aux | grep -i "cron" --color=auto

- List binaries within /usr -
ls -lh /usr/bin

- List binaries within /sbin -
ls -la /usr/sbin

- List RPM-based packages -
rpm -qa

- List Debian-based packages -
dpkg -l
##################################################################################
=== User information ===
cat /etc/passwd | grep sh$

id
whoami
groups

cat /etc/groups

- Interesting files -
find / -type f -name <user> 2>/dev/null | grep -Ev "^/proc"
find / -mmin -10 2>/dev/null | grep -Ev "^/proc"

- Logged in information -
w
who
last

- Sudo permissions -
sudo -l

- Switch User -
su <user>
sudo su - 
##################################################################################
=== Network Enumeration ===
ifconfig
ip a

ss -tuln
ss -lvntp

ip route
ip neigh

netstat -anl

cat /etc/resolv.conf
cat /etc/hosts
##################################################################################
