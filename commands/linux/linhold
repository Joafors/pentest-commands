\033[0;34m##################################################################################
\033[1;35m=== NOPASSWD ===\033[0m
sudo -l

\033[0;31mexample:\033[0m
User demo may run the following commands on crashlab:
    (root) NOPASSWD: /usr/bin/vim

\033[0;34m##################################################################################
\033[1;35m=== Find SUID Binaries ===\033[0m
find / -perm -u=s -type f -exec ls -la {} 2>/dev/null \;

\033[0;34m##################################################################################
\033[1;35m=== Find GUID Binaries ===\033[0m
find / -perm -g=s -type f -exec ls -la {} 2>/dev/null \;

\033[0;34m##################################################################################
\033[1;35m=== Cronjobs ===\033[0m
ls -lah /etc/cron*

cat /etc/crontab
crontab -l
systemctl list-timers --all

\033[0;31m- List cronjobs of Root using sudo -\033[0m
sudo crontab -l

\033[0;31m- List cron activities in syslog -\033[0m
grep "CRON" /var/log/syslog

\033[0;34m##################################################################################
\033[1;35m=== Mounted drives & disks ===\033[0m
\033[0;31m- Mounted at boot time -\033[0m
cat /etc/fstab

\033[0;31m- All mounted filesystems -\033[0m
mount

\033[0;31m- View all available disks/drives -\033[0m
lsblk

\033[0;34m##################################################################################
\033[1;35m=== List Kernel modules ===\033[0m
\033[0;31m- List kernel modules -\033[0m
lsmod

\033[0;31m- Find out more info about specific module -\033[0m
/sbin/modinfo <module>

\033[0;34m##################################################################################
\033[1;35m=== Stored Passwords ===\033[0m
history
cat ~/.bash_history
cat ~/.zsh_history

\033[0;31m- Files containing passwords -\033[0m
grep --color=auto -rnw '/' -ie "PASSWORD" --color=always 2>/dev/null

find . -type f -exec grep -i -I "PASSWORD" {} 2>/dev/null \; 

find . -type f -name *.config -exec grep -i -I "PASSWORD" {} 2>/dev/null \; 

find . -type f -name *config* -exec grep -i -I "PASSWORD" {} 2>/dev/null \; 

\033[0;31m- Old passwords -\033[0m
cat /etc/security/opasswd 

\033[0;31m- Last edited files -\033[0m
find / -mmin -10 2> /dev/null | grep -Ev "^/proc"

\033[0;31m- In memory passwords -\033[0m
strings /dev/mem -n10 | grep -i "PASS"

\033[0;34m##################################################################################
\033[1;35m=== Weak file permission ===\033[0m
ls -la /etc/passwd
ls -la /etc/shadow

ls -la /<path_to_file>

\033[0;34m##################################################################################
\033[1;35m=== Writable files/dirs ===\033[0m
find / -writable ! -user `whoami` -type f ! -path "/proc/*" ! -path "/sys/*" -exec ls -al {} \; 2>/dev/null

find / -writable -type d 2>/dev/null

find / -perm -2 -type f 2>/dev/null

find / ! -path "*/proc/*" -perm -2 -type f -print 2>/dev/null

\033[0;34m##################################################################################
\033[1;35m=== Find SSH Keys ===\033[0m
find / -name authorized_keys 2> /dev/null

find / -name id_rsa 2> /dev/null

\033[0;34m##################################################################################
\033[1;35m=== System enumeration ===\033[0m
\033[0;31m- System information -\033[0m
hostname
uname -a 
cat /etc/*-release
cat /proc/version
lscpu

\033[0;31m- Processes -\033[0m
ps -auxf
ps -aux
ps -aux | grep -i "root" --color=auto
ps -aux | grep -i "cron" --color=auto

\033[0;31m- Watch for specific processes (updated every one sec) -\033[0m
watch -n 1 "ps -aux | grep <usecase>"

\033[0;31m- Inspect real UID and effective UID assigned for process -\033[0m
grep Uid /proc/<pid>/status

\033[0;31m- processes being ran by root (REALTIME) -\033[0m
top -u root -c

\033[1;31mIn "top" press "o" and enter COMMAND=</bin/sh> to filter for specific scripts etc.\033[0m

\033[0;31m- List binaries within /usr -\033[0m
ls -lh /usr/bin

\033[0;31m- List binaries within /sbin -\033[0m
ls -la /usr/sbin

\033[0;31m- List RPM-based packages -\033[0m
rpm -qa

\033[0;31m- List Debian-based packages -\033[0m
dpkg -l

\033[0;34m##################################################################################
\033[1;35m=== User information ===\033[0m
\033[0;31m- Grep everything ending with sh from /etc/passwd (trick to grab users) -\033[0m
cat /etc/passwd | grep sh$

\033[0;31m- User uID, user gID, and groups -\033[0m
id

\033[0;31m- current user -\033[0m
whoami

\033[0;31m- groups user are in -\033[0m
groups

\033[0;31m- existing groups -\033[0m
cat /etc/groups

\033[0;31m- Interesting files -\033[0m
find / -type f -name <user> 2>/dev/null | grep -Ev "^/proc"
find / -mmin -10 2>/dev/null | grep -Ev "^/proc"

\033[0;31m- Logged in information -\033[0m
w
who
last

\033[0;31m- Sudo permissions -\033[0m
sudo -l

\033[0;31m- Switch User -\033[0m
su <user>
sudo su -

\033[0;31m- Sudo version -\033[0m
sudo --version

\033[0;34m##################################################################################
\033[1;35m=== Network Enumeration ===\033[0m
\033[0;31m- IP configuration -\033[0m
ifconfig
ip a

\033[0;31m- Listening ports -\033[0m
ss -tuln
ss -lvntp
ss -anp

\033[0;31m- Neighbors & Routes -\033[0m
ip route
ip neigh
routel

\033[0;31m- Established connections & Listening ports -\033[0m
netstat -anl

\033[0;31m- DNS resolv -\033[0m
cat /etc/resolv.conf

\033[0;31m- Hosts/domainnames (DNS) -\033[0m
cat /etc/hosts

\033[0;31m- Capture traffic in and out (loopback interface) -\033[0m
sudo tcpdump -i lo -A | grep "<pass>"

\033[0;34m##################################################################################\033[0m
\033[1;35m=== use strace to discover potential privesc vectors ===\033[0m
\033[0;31mon attacker machine:\033[0m
strace -e trace=file -o trace.txt <FULL_COMMAND_TO_TRACE>
cat trace.txt

\033[1;31mEXAMPLE:\033[0m
strace -e trace=file -o trace.txt /usr/bin/python -m smtpd -n -c DebuggingServer 0.0.0.0\:25
cat trace.txt

\033[0;34m##################################################################################
\033[1;35m=== Automated enumeration ===\033[0m
\033[0;31m- Linpeas -\033[0m
wget "https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh" -O linpeas.sh
sh linpeas.sh

\033[0;34m##################################################################################
\n
